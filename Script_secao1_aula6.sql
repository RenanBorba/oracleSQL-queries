-- CRIAR TABELA
CREATE TABLE TALUNO
(
  COD_ALUNO INTEGER NOT NULL,
  NOME VARCHAR(30),
  CIDADE VARCHAR2(20),
  CEP VARCHAR(10),
  -- CHAVE IDENTIFICADORA DA TABELA
  PRIMARY KEY (COD_ALUNO)
);

-- SELECT BÁSICO
SELECT * FROM TALUNO;

-- INSERIR DADOS NA TABELA
INSERT INTO TALUNO(COD_ALUNO, NOME, CIDADE, CEP)
VALUES (1, 'RENAN', 'NOVO HAMBURGO', '93000000');

INSERT INTO TALUNO(COD_ALUNO, NOME, CIDADE, CEP)
VALUES (2, 'PAULO', 'ITAPIRA', '94000000');

INSERT INTO TALUNO(COD_ALUNO, NOME, CIDADE, CEP)
VALUES (3, 'PAULO', 'SINOP', '95000000')

INSERT INTO TALUNO(COD_ALUNO, NOME, CIDADE, CEP)
VALUES (4, 'IGOR', 'SINOP', '95000000');

INSERT INTO TALUNO(COD_ALUNO, NOME, CIDADE, CEP)
VALUES (5, 'MARCELO', 'BEBEDOURO', '96000000');


CREATE TABLE TCURSO
(
  COD_CURSO INTEGER NOT NULL PRIMARY KEY,
  NOME VARCHAR2(30),
  -- 8: PRECISÃO É O NÚMERO DE DÍGITOS EM UM NÚMERO
  -- 2: ESCALA É O NÚMERO DE DÍGITOS À DIREITA DO PONTO DECIMAL
  VALOR NUMBER(8,2),
  CARGA_HORARIO INTEGER
)

SELECT * FROM TCURSO

-- ; PERMITE EXECUTAR MAIS DE UMA LINHA NO MESMO COMANDO
INSERT INTO TCURSO VALUES(1, 'ORACLE SQL E PL/SQL', 500, 25);
INSERT INTO TCURSO VALUES(2, 'ORACLE DBA', 499, 25);
INSERT INTO TCURSO VALUES(3, 'JAVA FUNDAMENTOS E OO', 1500, 100);
INSERT INTO TCURSO VALUES(4, 'JAVASERVER FACES', 1600, 100);


CREATE TABLE TCONTRATO
(
  COD_CONTRATO INTEGER NOT NULL PRIMARY KEY,
  DATA DATE,
  COD_ALUNO INTEGER,
  TOTAL NUMBER(8,2),
  DESCONTO NUMBER(5,2)
);

SELECT * FROM TCONTRATO

-- SYSDATE: FUNÇÃO DATA/HORA DA MÁQUINA
INSERT INTO TCONTRATO VALUES(1, SYSDATE,   1, 500, 10);
INSERT INTO TCONTRATO VALUES(2, SYSDATE,   2, 500, 10);
INSERT INTO TCONTRATO VALUES(3, SYSDATE,   3, 1500, 05);
-- SYSDATE-5: MENOS 5 DIAS
INSERT INTO TCONTRATO VALUES(4, SYSDATE-5, 2, 1600, 10);
INSERT INTO TCONTRATO VALUES(5, SYSDATE-4, 5, 800, 10);
INSERT INTO TCONTRATO VALUES(6, SYSDATE-3, 5, 445, 0);
INSERT INTO TCONTRATO VALUES(7, SYSDATE-2, 5, 445, 20);

-- ALTERAR TABELA E ADICIONAR COLUNA
ALTER TABLE TCONTRATO ADD COL_TESTE VARCHAR(50)

-- ALTERAR TABELA E EXCLUIR COLUNA
ALTER TABLE TCONTRATO DROP COLUMN COL_TESTE

-- ALTERAR NOME DA COLUNA
ALTER TABLE TALUNO RENAME COLUMN NOME TO NOME2;
ALTER TABLE TALUNO RENAME COLUMN NOME2 TO NOME

/*
CLICAR EM CIMA DO NOME DA TABELA E APERTAR F12: ABRE O PAINEL OBJECT VIEWER,
COM AS ESTRUTURAS DA TABELA, COMO COLUNAS E REFERÊNCIAS
*/

-- EXCLUIR TABELA
DROP TABLE NOME_TABELA


-- CRIAR SEQUÊNCIA PARA INSERÇÃO, NO CASO COMEÇANDO COM 4
CREATE SEQUENCE SEQ_ALUNO START WITH 4;

-- EXCLUIR SEQUÊNCIA
DROP SEQUENCE SEQ_ALUNO

CREATE SEQUENCE SEQ_ALUNO START WITH 6;

INSERT INTO TALUNO(COD_ALUNO, NOME, CIDADE, CEP)
-- INSERIR O VALOR 6 NA COLUNA "COD_ALUNO"
VALUES (SEQ_ALUNO.NEXTVAL, 'VALDO', 'CANOAS', '11000000');

INSERT INTO TALUNO(COD_ALUNO, NOME, CIDADE, CEP)
-- INSERIR O PRÓXIMO VALOR AO NÚMERO "6"
VALUES (SEQ_ALUNO.NEXTVAL, 'ANDRÉ', 'IVOTI', '12000000');

SELECT * FROM TALUNO


/*
DATA/HORA ATUAL DO SERVIDOR/COMPUTADOR
  DUAL: TABELA FICTÍCIA PARA EXECUTAR FUNÇÕES, SEM ABSTRAIR DADOS,
    APENAS PARA VALIDAÇÃO DO COMANDO
*/
SELECT SYSDATE FROM DUAL;

-- VALOR ATUAL DA SEQUÊNCIA
SELECT SEQ_ALUNO.CURRVAL FROM DUAL


-- CONTROLE DE TRANSAÇÃO (COMMIT E ROLLBACK)
-- CONFIRMAR ALTERAÇÕES REALIZADAS (INSERT, UPDATE E DELETE)
COMMIT;

SELECT * FROM TALUNO;

-- APAGAR APENAS DADOS, DIFERENTE DE "DROP"
DELETE FROM TALUNO;


-- DESFAZER ALTERAÇÕES REALIZADAS (INSERT, UPDATE E DELETE)
ROLLBACK;


-- EXCLUIR REGISTRO DA TABELA COM CONDIÇÃO
DELETE FROM TALUNO
-- ONDE
WHERE COD_ALUNO = 7

ROLLBACK;

-- CONSULTA COM FILTRO
SELECT * FROM TALUNO
WHERE NOME = 'VALDO';

DELETE FROM TALUNO
WHERE NOME = 'VALDO';

-- APÓS REALIZAR O COMMIT,
COMMIT;

-- NÃO SERÁ POSSÍVEL DESFAZER ALTERAÇÕES VIA ROLLBACK
ROLLBACK;


CREATE TABLE TITEM
(
  COD_ITEM INTEGER NOT NULL PRIMARY KEY,
  COD_CURSO INTEGER,
  COD_CONTRATO INTEGER,
  VALOR NUMBER(8,2)
);

INSERT INTO TITEM VALUES (1,1,1,500);
INSERT INTO TITEM VALUES (2,1,2,500);
INSERT INTO TITEM VALUES (3,3,3,1500);
INSERT INTO TITEM VALUES (4,4,4,1600);
INSERT INTO TITEM VALUES (5,1,5,500);
INSERT INTO TITEM VALUES (6,1,6,500);
INSERT INTO TITEM VALUES (7,2,6,500);
INSERT INTO TITEM VALUES (8,3,7,500);

COMMIT;

SELECT * FROM TITEM

SELECT * FROM TCONTRATO
WHERE COD_CONTRATO = 2;


-- ALTERAR REGISTRO DA TABELA
UPDATE TCONTRATO SET
  DESCONTO = 18
WHERE COD_CONTRATO = 2;

UPDATE TCONTRATO SET
  DESCONTO = 20,
  DATA = '05/06/2013',
  TOTAL = 750
WHERE COD_CONTRATO = 2;


SELECT * FROM TALUNO

INSERT INTO TALUNO(COD_ALUNO, NOME, CIDADE, CEP)
VALUES (SEQ_ALUNO.NEXTVAL, 'CARLOS', 'BEBEDOURO', '14000000');

UPDATE TALUNO SET
  CIDADE = 'GUARIBA'
-- COMPARA A COLUNA POR LETRAS MAIÚSCULAS
WHERE UPPER(CIDADE) = 'BEBEDOURO';

UPDATE TALUNO SET
  NOME = 'FRIDA'
WHERE COD_ALUNO = 3;

SELECT * FROM TCURSO

UPDATE TCURSO SET
  VALOR = 499.99
WHERE COD_CURSO = 1;

COMMIT;


-- ALT + 3 = ABRE LISTA DE TABELAS E ESTRUTURAS
s






